<Cube xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ddl2="http://schemas.microsoft.com/analysisservices/2003/engine/2" xmlns:ddl2_2="http://schemas.microsoft.com/analysisservices/2003/engine/2/2" xmlns:ddl100_100="http://schemas.microsoft.com/analysisservices/2008/engine/100/100" xmlns:ddl200="http://schemas.microsoft.com/analysisservices/2010/engine/200" xmlns:ddl200_200="http://schemas.microsoft.com/analysisservices/2010/engine/200/200" xmlns:ddl300="http://schemas.microsoft.com/analysisservices/2011/engine/300" xmlns:ddl300_300="http://schemas.microsoft.com/analysisservices/2011/engine/300/300" xmlns:ddl400="http://schemas.microsoft.com/analysisservices/2012/engine/400" xmlns:ddl400_400="http://schemas.microsoft.com/analysisservices/2012/engine/400/400" xmlns:ddl500="http://schemas.microsoft.com/analysisservices/2013/engine/500" xmlns:ddl500_500="http://schemas.microsoft.com/analysisservices/2013/engine/500/500" xmlns:dwd="http://schemas.microsoft.com/DataWarehouse/Designer/1.0" dwd:design-time-name="f9960759-75b0-4dd1-8977-6e356aba76c6" xmlns="http://schemas.microsoft.com/analysisservices/2003/engine">
  <ID>Finance Cube</ID>
  <MeasureGroups>
    <MeasureGroup>
      <ID>Fact Bill</ID>
      <Partitions>
        <Partition dwd:design-time-name="9bb26886-0648-443b-b273-bdc4386de0f4">
          <ID>Fact Bill</ID>
          <Name>Fact Bill Current Year</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="5590f160-fe5b-4490-9d93-bfc932bd72bd">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_bill.dim_matter_header_curr_key, fact_bill.dim_client_key, fact_bill.dim_bill_date_key, fact_bill.dim_bill_key, fact_bill.dim_posting_date_key, fact_bill.dim_last_pay_date_key, 
                         fact_bill.dim_address_key, fact_bill.dim_write_off_codes_key, fact_bill.master_fact_key, fact_bill.source_system_id, fact_bill.client_code, fact_bill.matter_number, fact_bill.bill_number, 
                         fact_bill.bill_sequence, fact_bill.bill_total, fact_bill.fees_total, fact_bill.paid_disbursements, fact_bill.unpaid_disbursements, fact_bill.admin_charges_total, fact_bill.vat_amount, 
                         fact_bill.amount_paid, fact_bill.amount_outstanding, fact_bill.fact_bill_key, fact_bill.dss_update_time, fact_bill.dim_bill_debt_narrative_key, 
                         dim_fed_hierarchy_history.dim_fed_hierarchy_history_key AS matter_owner_history_key, dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM         fact_bill INNER JOIN
                         dim_matter_header_current ON dim_matter_header_current.dim_matter_header_curr_key = fact_bill.dim_matter_header_curr_key INNER JOIN
                         dim_date ON fact_bill.dim_bill_date_key = dim_date.dim_date_key LEFT OUTER JOIN
                         dim_fed_hierarchy_history ON dim_fed_hierarchy_history.fed_code = dim_matter_header_current.fee_earner_code AND dim_date.calendar_date BETWEEN 
                         dim_fed_hierarchy_history.dss_start_date AND dim_fed_hierarchy_history.dss_end_date
						 INNER join dim_days_banding on DATEDIFF(d, calendar_date, GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
						 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   current_fin_year = 'Current' AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
          <EstimatedRows>1836255</EstimatedRows>
        </Partition>
        <Partition dwd:design-time-name="100b7d4a-6a0d-47a7-8e51-2481202a275c">
          <ID>Fact Bill 1</ID>
          <Name>Fact Bill 1 and 2 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="a42e9fa7-3f04-4c09-a9f3-07a35fc82ad6">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_bill.dim_matter_header_curr_key, fact_bill.dim_client_key, fact_bill.dim_bill_date_key, fact_bill.dim_bill_key, fact_bill.dim_posting_date_key, fact_bill.dim_last_pay_date_key, 
                         fact_bill.dim_address_key, fact_bill.dim_write_off_codes_key, fact_bill.master_fact_key, fact_bill.source_system_id, fact_bill.client_code, fact_bill.matter_number, fact_bill.bill_number, 
                         fact_bill.bill_sequence, fact_bill.bill_total, fact_bill.fees_total, fact_bill.paid_disbursements, fact_bill.unpaid_disbursements, fact_bill.admin_charges_total, fact_bill.vat_amount, 
                         fact_bill.amount_paid, fact_bill.amount_outstanding, fact_bill.fact_bill_key, fact_bill.dss_update_time, fact_bill.dim_bill_debt_narrative_key, 
                         dim_fed_hierarchy_history.dim_fed_hierarchy_history_key AS matter_owner_history_key, dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM         fact_bill INNER JOIN
                         dim_matter_header_current ON dim_matter_header_current.dim_matter_header_curr_key = fact_bill.dim_matter_header_curr_key INNER JOIN
                         dim_date ON fact_bill.dim_bill_date_key = dim_date.dim_date_key LEFT OUTER JOIN
                         dim_fed_hierarchy_history ON dim_fed_hierarchy_history.fed_code = dim_matter_header_current.fee_earner_code AND dim_date.calendar_date BETWEEN 
                         dim_fed_hierarchy_history.dss_start_date AND dim_fed_hierarchy_history.dss_end_date
						 INNER join dim_days_banding on DATEDIFF(d, calendar_date, GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
						 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						 
WHERE   fin_year BETWEEN (SELECT DISTINCT fin_year - 2
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current')  AND   (SELECT DISTINCT fin_year - 1
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current') AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="3976bd85-8fa7-449d-ab69-1ada61ab791e">
          <ID>Fact Bill 3 and 4 years old</ID>
          <Name>Fact Bill 3 and 4 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="2a8d9926-7629-4deb-8127-c36c2db06ae2">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_bill.dim_matter_header_curr_key, fact_bill.dim_client_key, fact_bill.dim_bill_date_key, fact_bill.dim_bill_key, fact_bill.dim_posting_date_key, fact_bill.dim_last_pay_date_key, 
                         fact_bill.dim_address_key, fact_bill.dim_write_off_codes_key, fact_bill.master_fact_key, fact_bill.source_system_id, fact_bill.client_code, fact_bill.matter_number, fact_bill.bill_number, 
                         fact_bill.bill_sequence, fact_bill.bill_total, fact_bill.fees_total, fact_bill.paid_disbursements, fact_bill.unpaid_disbursements, fact_bill.admin_charges_total, fact_bill.vat_amount, 
                         fact_bill.amount_paid, fact_bill.amount_outstanding, fact_bill.fact_bill_key, fact_bill.dss_update_time, fact_bill.dim_bill_debt_narrative_key, 
                         dim_fed_hierarchy_history.dim_fed_hierarchy_history_key AS matter_owner_history_key, dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM         fact_bill INNER JOIN
                         dim_matter_header_current ON dim_matter_header_current.dim_matter_header_curr_key = fact_bill.dim_matter_header_curr_key INNER JOIN
                         dim_date ON fact_bill.dim_bill_date_key = dim_date.dim_date_key LEFT OUTER JOIN
                         dim_fed_hierarchy_history ON dim_fed_hierarchy_history.fed_code = dim_matter_header_current.fee_earner_code AND dim_date.calendar_date BETWEEN 
                         dim_fed_hierarchy_history.dss_start_date AND dim_fed_hierarchy_history.dss_end_date
						 INNER join dim_days_banding on DATEDIFF(d, calendar_date, GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
						 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   fin_year BETWEEN (SELECT DISTINCT fin_year - 4
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 3
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="5e56fd86-3e3f-460d-aa25-2277a80b64c8">
          <ID>Fact Bill 5 and 6 years old</ID>
          <Name>Fact Bill 5 and 6 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="07c916e2-cde6-45af-83ed-7a42ba3dd4ff">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_bill.dim_matter_header_curr_key, fact_bill.dim_client_key, fact_bill.dim_bill_date_key, fact_bill.dim_bill_key, fact_bill.dim_posting_date_key, fact_bill.dim_last_pay_date_key, 
                         fact_bill.dim_address_key, fact_bill.dim_write_off_codes_key, fact_bill.master_fact_key, fact_bill.source_system_id, fact_bill.client_code, fact_bill.matter_number, fact_bill.bill_number, 
                         fact_bill.bill_sequence, fact_bill.bill_total, fact_bill.fees_total, fact_bill.paid_disbursements, fact_bill.unpaid_disbursements, fact_bill.admin_charges_total, fact_bill.vat_amount, 
                         fact_bill.amount_paid, fact_bill.amount_outstanding, fact_bill.fact_bill_key, fact_bill.dss_update_time, fact_bill.dim_bill_debt_narrative_key, 
                         dim_fed_hierarchy_history.dim_fed_hierarchy_history_key AS matter_owner_history_key, dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM         fact_bill INNER JOIN
                         dim_matter_header_current ON dim_matter_header_current.dim_matter_header_curr_key = fact_bill.dim_matter_header_curr_key INNER JOIN
                         dim_date ON fact_bill.dim_bill_date_key = dim_date.dim_date_key LEFT OUTER JOIN
                         dim_fed_hierarchy_history ON dim_fed_hierarchy_history.fed_code = dim_matter_header_current.fee_earner_code AND dim_date.calendar_date BETWEEN 
                         dim_fed_hierarchy_history.dss_start_date AND dim_fed_hierarchy_history.dss_end_date
						 INNER join dim_days_banding on DATEDIFF(d, calendar_date, GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
						 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   fin_year BETWEEN (SELECT DISTINCT fin_year - 6
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 5
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="20c1e8bd-114a-4e65-8edc-a62fd960aef3">
          <ID>Fact Bill 7 and 8 years old</ID>
          <Name>Fact Bill 7 and 8 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="7c247050-33df-4068-9a5b-ba60a69a179d">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_bill.dim_matter_header_curr_key, fact_bill.dim_client_key, fact_bill.dim_bill_date_key, fact_bill.dim_bill_key, fact_bill.dim_posting_date_key, fact_bill.dim_last_pay_date_key, 
                         fact_bill.dim_address_key, fact_bill.dim_write_off_codes_key, fact_bill.master_fact_key, fact_bill.source_system_id, fact_bill.client_code, fact_bill.matter_number, fact_bill.bill_number, 
                         fact_bill.bill_sequence, fact_bill.bill_total, fact_bill.fees_total, fact_bill.paid_disbursements, fact_bill.unpaid_disbursements, fact_bill.admin_charges_total, fact_bill.vat_amount, 
                         fact_bill.amount_paid, fact_bill.amount_outstanding, fact_bill.fact_bill_key, fact_bill.dss_update_time, fact_bill.dim_bill_debt_narrative_key, 
                         dim_fed_hierarchy_history.dim_fed_hierarchy_history_key AS matter_owner_history_key, dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM         fact_bill INNER JOIN
                         dim_matter_header_current ON dim_matter_header_current.dim_matter_header_curr_key = fact_bill.dim_matter_header_curr_key INNER JOIN
                         dim_date ON fact_bill.dim_bill_date_key = dim_date.dim_date_key LEFT OUTER JOIN
                         dim_fed_hierarchy_history ON dim_fed_hierarchy_history.fed_code = dim_matter_header_current.fee_earner_code AND dim_date.calendar_date BETWEEN 
                         dim_fed_hierarchy_history.dss_start_date AND dim_fed_hierarchy_history.dss_end_date
						 INNER join dim_days_banding on DATEDIFF(d, calendar_date, GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
						 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   fin_year BETWEEN (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 7
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="db75c26f-6e0a-4a19-88d5-55a9750aa09e">
          <ID>Fact Bill greater than 8 years old</ID>
          <Name>Fact Bill greater than 8 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="8d7a8535-80ff-4fcc-8e1c-56241a5ee8b8">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_bill.dim_matter_header_curr_key, fact_bill.dim_client_key, fact_bill.dim_bill_date_key, fact_bill.dim_bill_key, fact_bill.dim_posting_date_key, fact_bill.dim_last_pay_date_key, 
                         fact_bill.dim_address_key, fact_bill.dim_write_off_codes_key, fact_bill.master_fact_key, fact_bill.source_system_id, fact_bill.client_code, fact_bill.matter_number, fact_bill.bill_number, 
                         fact_bill.bill_sequence, fact_bill.bill_total, fact_bill.fees_total, fact_bill.paid_disbursements, fact_bill.unpaid_disbursements, fact_bill.admin_charges_total, fact_bill.vat_amount, 
                         fact_bill.amount_paid, fact_bill.amount_outstanding, fact_bill.fact_bill_key, fact_bill.dss_update_time, fact_bill.dim_bill_debt_narrative_key, 
                         dim_fed_hierarchy_history.dim_fed_hierarchy_history_key AS matter_owner_history_key, dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM         fact_bill INNER JOIN
                         dim_matter_header_current ON dim_matter_header_current.dim_matter_header_curr_key = fact_bill.dim_matter_header_curr_key INNER JOIN
                         dim_date ON fact_bill.dim_bill_date_key = dim_date.dim_date_key LEFT OUTER JOIN
                         dim_fed_hierarchy_history ON dim_fed_hierarchy_history.fed_code = dim_matter_header_current.fee_earner_code AND dim_date.calendar_date BETWEEN 
                         dim_fed_hierarchy_history.dss_start_date AND dim_fed_hierarchy_history.dss_end_date
						 INNER join dim_days_banding on DATEDIFF(d, calendar_date, GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
						 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   fin_year &lt; (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  
AND  (fact_bill.dim_bill_date_key &gt;= 20100501) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
    </MeasureGroup>
    <MeasureGroup>
      <ID>Fact Bill Activity</ID>
      <Partitions>
        <Partition dwd:design-time-name="3004dfbe-82d6-4667-8c97-ec0b7acbf938">
          <ID>Fact Bill Activity</ID>
          <Name>Fact Bill Activity Current Year</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="f6ef1ca9-25f8-4cc0-aa39-d337c6838b50">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT CAST(fact_bill_activity.fact_bill_activity_key AS BIGINT) AS fact_bill_activity_key, fact_bill_activity.dim_client_key, fact_bill_activity.dim_bill_date_key, fact_bill_activity.dim_bill_key, fact_bill_activity.dim_fed_hierarchy_history_key, fact_bill_activity.dim_matter_header_curr_key, 
             fact_bill_activity.billed_time, fact_bill_activity.bill_amount, dim_days_banding.dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key, bill_number, fact_bill_activity.source_system_id
FROM   fact_bill_activity INNER JOIN
             dim_days_banding ON DATEDIFF(d, GETDATE(), fact_bill_activity.gldate) BETWEEN dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
	left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_activity.master_fact_key
	LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
				CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE     dim_bill_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE current_fin_year = 'Current')
 AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
UNION ALL


SELECT    CAST('999' + CAST(fact_billable_time_activity.source_system_id AS VARCHAR(2)) + CAST(fact_billable_time_activity.transaction_sequence_number AS VARCHAR(25)) AS bigint) AS EXPR1,
		fact_billable_time_activity.dim_client_key, fact_billable_time_activity.dim_orig_posting_date_key, fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_fed_hierarchy_history_key, 
             fact_billable_time_activity.dim_matter_header_curr_key, NULL AS EXPR2, NULL AS EXPR3, dim_days_banding_1.dim_days_banding_key, ISNULL(dim_client_1.client_code, 'Unknown') AS master_client_code, 
				ISNULL(fact_dimension_main_1.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, '0' AS EXPR4, fact_billable_time_activity.source_system_id
FROM     fact_billable_time_activity INNER JOIN
             dim_days_banding AS dim_days_banding_1 ON DATEDIFF(d, CAST(CONVERT(CHAR(10), fact_billable_time_activity.dim_orig_posting_date_key, 120) AS DATE), GETDATE()) BETWEEN dim_days_banding_1.startdays AND dim_days_banding_1.enddays AND dim_days_banding_1.banding_category = 'grouping3' 
			 LEFT outer JOIN
             fact_dimension_main AS fact_dimension_main_1 ON fact_dimension_main_1.dim_matter_header_curr_key = fact_billable_time_activity.dim_matter_header_curr_key
						AND fact_billable_time_activity.source_system_id = fact_dimension_main_1.source_system_id
			 LEFT OUTER JOIN
             dim_client AS dim_client_1 ON dim_client_1.client_code = CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   (fact_billable_time_activity.dim_bill_key = 0)
AND (dim_orig_posting_date_key IS NOT NULL)
and     dim_orig_posting_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE current_fin_year = 'Current') AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
          <EstimatedRows>1141527</EstimatedRows>
        </Partition>
        <Partition dwd:design-time-name="abab9364-e6b1-4be5-926b-069fe1f1982b">
          <ID>Fact Bill Activity Historical</ID>
          <Name>Fact Bill Activity 1 and 2 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="bc84e987-1fa1-47b4-a998-5bf300745e27">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT CAST(fact_bill_activity.fact_bill_activity_key AS BIGINT) AS fact_bill_activity_key, fact_bill_activity.dim_client_key, fact_bill_activity.dim_bill_date_key, fact_bill_activity.dim_bill_key, fact_bill_activity.dim_fed_hierarchy_history_key, fact_bill_activity.dim_matter_header_curr_key, 
             fact_bill_activity.billed_time, fact_bill_activity.bill_amount, dim_days_banding.dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key, bill_number, fact_bill_activity.source_system_id
FROM   fact_bill_activity INNER JOIN
             dim_days_banding ON DATEDIFF(d, GETDATE(), fact_bill_activity.gldate) BETWEEN dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
	left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_activity.master_fact_key
	LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
				CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE     dim_bill_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year BETWEEN  (SELECT DISTINCT fin_year - 2
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 1
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)	)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
UNION ALL


SELECT    CAST('999' + CAST(fact_billable_time_activity.source_system_id AS VARCHAR(2)) + CAST(fact_billable_time_activity.transaction_sequence_number AS VARCHAR(25)) AS bigint) AS EXPR1,
		fact_billable_time_activity.dim_client_key, fact_billable_time_activity.dim_orig_posting_date_key, fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_fed_hierarchy_history_key, 
             fact_billable_time_activity.dim_matter_header_curr_key, NULL AS EXPR2, NULL AS EXPR3, dim_days_banding_1.dim_days_banding_key, ISNULL(dim_client_1.client_code, 'Unknown') AS master_client_code, 
				ISNULL(fact_dimension_main_1.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, '0' AS EXPR4, fact_billable_time_activity.source_system_id
FROM     fact_billable_time_activity INNER JOIN
             dim_days_banding AS dim_days_banding_1 ON DATEDIFF(d, CAST(CONVERT(CHAR(10), fact_billable_time_activity.dim_orig_posting_date_key, 120) AS DATE), GETDATE()) BETWEEN dim_days_banding_1.startdays AND dim_days_banding_1.enddays AND dim_days_banding_1.banding_category = 'grouping3' 
			 LEFT outer JOIN
             fact_dimension_main AS fact_dimension_main_1 ON fact_dimension_main_1.dim_matter_header_curr_key = fact_billable_time_activity.dim_matter_header_curr_key
						AND fact_billable_time_activity.source_system_id = fact_dimension_main_1.source_system_id
			 LEFT OUTER JOIN
             dim_client AS dim_client_1 ON dim_client_1.client_code = CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   (fact_billable_time_activity.dim_bill_key = 0)
AND (dim_orig_posting_date_key IS NOT NULL)
and     dim_orig_posting_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year BETWEEN  (SELECT DISTINCT fin_year - 2
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 1
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)	) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="634850f8-077b-4cb2-b9a9-ed5439e60e06">
          <ID>Fact Bill Activity 3 and 4 years old</ID>
          <Name>Fact Bill Activity 3 and 4 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="4f154678-da63-4295-9fca-e9a26fc5b3eb">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT CAST(fact_bill_activity.fact_bill_activity_key AS BIGINT) AS fact_bill_activity_key, fact_bill_activity.dim_client_key, fact_bill_activity.dim_bill_date_key, fact_bill_activity.dim_bill_key, fact_bill_activity.dim_fed_hierarchy_history_key, fact_bill_activity.dim_matter_header_curr_key, 
             fact_bill_activity.billed_time, fact_bill_activity.bill_amount, dim_days_banding.dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key, bill_number, fact_bill_activity.source_system_id
FROM   fact_bill_activity INNER JOIN
             dim_days_banding ON DATEDIFF(d, GETDATE(), fact_bill_activity.gldate) BETWEEN dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
	left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_activity.master_fact_key
	LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
				CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE     dim_bill_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year BETWEEN  (SELECT DISTINCT fin_year - 4
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 3
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)	)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
UNION ALL


SELECT    CAST('999' + CAST(fact_billable_time_activity.source_system_id AS VARCHAR(2)) + CAST(fact_billable_time_activity.transaction_sequence_number AS VARCHAR(25)) AS bigint) AS EXPR1,
		fact_billable_time_activity.dim_client_key, fact_billable_time_activity.dim_orig_posting_date_key, fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_fed_hierarchy_history_key, 
             fact_billable_time_activity.dim_matter_header_curr_key, NULL AS EXPR2, NULL AS EXPR3, dim_days_banding_1.dim_days_banding_key, ISNULL(dim_client_1.client_code, 'Unknown') AS master_client_code, 
				ISNULL(fact_dimension_main_1.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, '0' AS EXPR4, fact_billable_time_activity.source_system_id
FROM     fact_billable_time_activity INNER JOIN
             dim_days_banding AS dim_days_banding_1 ON DATEDIFF(d, CAST(CONVERT(CHAR(10), fact_billable_time_activity.dim_orig_posting_date_key, 120) AS DATE), GETDATE()) BETWEEN dim_days_banding_1.startdays AND dim_days_banding_1.enddays AND dim_days_banding_1.banding_category = 'grouping3' 
			 LEFT outer JOIN
             fact_dimension_main AS fact_dimension_main_1 ON fact_dimension_main_1.dim_matter_header_curr_key = fact_billable_time_activity.dim_matter_header_curr_key
						AND fact_billable_time_activity.source_system_id = fact_dimension_main_1.source_system_id
			 LEFT OUTER JOIN
             dim_client AS dim_client_1 ON dim_client_1.client_code = CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   (fact_billable_time_activity.dim_bill_key = 0)
AND (dim_orig_posting_date_key IS NOT NULL)
and     dim_orig_posting_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year BETWEEN  (SELECT DISTINCT fin_year - 4
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 3
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)	) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="71f80f21-f0c9-4842-b952-acdcf79900ef">
          <ID>Fact Bill Activity 5 and 6 years old</ID>
          <Name>Fact Bill Activity 5 and 6 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="7c089e20-a218-4d45-bf9b-765773e81ecc">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT CAST(fact_bill_activity.fact_bill_activity_key AS BIGINT) AS fact_bill_activity_key, fact_bill_activity.dim_client_key, fact_bill_activity.dim_bill_date_key, fact_bill_activity.dim_bill_key, fact_bill_activity.dim_fed_hierarchy_history_key, fact_bill_activity.dim_matter_header_curr_key, 
             fact_bill_activity.billed_time, fact_bill_activity.bill_amount, dim_days_banding.dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key, bill_number, fact_bill_activity.source_system_id
FROM   fact_bill_activity INNER JOIN
             dim_days_banding ON DATEDIFF(d, GETDATE(), fact_bill_activity.gldate) BETWEEN dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
	left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_activity.master_fact_key
	LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
				CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE     dim_bill_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year BETWEEN  (SELECT DISTINCT fin_year - 6
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 5
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)	)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
UNION ALL


SELECT    CAST('999' + CAST(fact_billable_time_activity.source_system_id AS VARCHAR(2)) + CAST(fact_billable_time_activity.transaction_sequence_number AS VARCHAR(25)) AS bigint) AS EXPR1,
		fact_billable_time_activity.dim_client_key, fact_billable_time_activity.dim_orig_posting_date_key, fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_fed_hierarchy_history_key, 
             fact_billable_time_activity.dim_matter_header_curr_key, NULL AS EXPR2, NULL AS EXPR3, dim_days_banding_1.dim_days_banding_key, ISNULL(dim_client_1.client_code, 'Unknown') AS master_client_code, 
				ISNULL(fact_dimension_main_1.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, '0' AS EXPR4, fact_billable_time_activity.source_system_id
FROM     fact_billable_time_activity INNER JOIN
             dim_days_banding AS dim_days_banding_1 ON DATEDIFF(d, CAST(CONVERT(CHAR(10), fact_billable_time_activity.dim_orig_posting_date_key, 120) AS DATE), GETDATE()) BETWEEN dim_days_banding_1.startdays AND dim_days_banding_1.enddays AND dim_days_banding_1.banding_category = 'grouping3' 
			 LEFT outer JOIN
             fact_dimension_main AS fact_dimension_main_1 ON fact_dimension_main_1.dim_matter_header_curr_key = fact_billable_time_activity.dim_matter_header_curr_key
						AND fact_billable_time_activity.source_system_id = fact_dimension_main_1.source_system_id
			 LEFT OUTER JOIN
             dim_client AS dim_client_1 ON dim_client_1.client_code = CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   (fact_billable_time_activity.dim_bill_key = 0)
AND (dim_orig_posting_date_key IS NOT NULL)
and     dim_orig_posting_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year BETWEEN  (SELECT DISTINCT fin_year - 6
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 5
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)	) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="90f7a32b-8916-47b0-bf1b-04ff7083831f">
          <ID>Fact Bill Activity 7 and 8 years old</ID>
          <Name>Fact Bill Activity 7 and 8 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="f08fe308-c1af-4aae-a4f7-6c38707921fe">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT CAST(fact_bill_activity.fact_bill_activity_key AS BIGINT) AS fact_bill_activity_key, fact_bill_activity.dim_client_key, fact_bill_activity.dim_bill_date_key, fact_bill_activity.dim_bill_key, fact_bill_activity.dim_fed_hierarchy_history_key, fact_bill_activity.dim_matter_header_curr_key, 
             fact_bill_activity.billed_time, fact_bill_activity.bill_amount, dim_days_banding.dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key, bill_number, fact_bill_activity.source_system_id
FROM   fact_bill_activity INNER JOIN
             dim_days_banding ON DATEDIFF(d, GETDATE(), fact_bill_activity.gldate) BETWEEN dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
	left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_activity.master_fact_key
	LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
				CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE     dim_bill_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year BETWEEN  (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 7
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)	)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
UNION ALL

SELECT    CAST('999' + CAST(fact_billable_time_activity.source_system_id AS VARCHAR(2)) + CAST(fact_billable_time_activity.transaction_sequence_number AS VARCHAR(25)) AS bigint) AS EXPR1,
		fact_billable_time_activity.dim_client_key, fact_billable_time_activity.dim_orig_posting_date_key, fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_fed_hierarchy_history_key, 
             fact_billable_time_activity.dim_matter_header_curr_key, NULL AS EXPR2, NULL AS EXPR3, dim_days_banding_1.dim_days_banding_key, ISNULL(dim_client_1.client_code, 'Unknown') AS master_client_code, 
				ISNULL(fact_dimension_main_1.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, '0' AS EXPR4, fact_billable_time_activity.source_system_id
FROM     fact_billable_time_activity INNER JOIN
             dim_days_banding AS dim_days_banding_1 ON DATEDIFF(d, CAST(CONVERT(CHAR(10), fact_billable_time_activity.dim_orig_posting_date_key, 120) AS DATE), GETDATE()) BETWEEN dim_days_banding_1.startdays AND dim_days_banding_1.enddays AND dim_days_banding_1.banding_category = 'grouping3' 
			 LEFT outer JOIN
             fact_dimension_main AS fact_dimension_main_1 ON fact_dimension_main_1.dim_matter_header_curr_key = fact_billable_time_activity.dim_matter_header_curr_key
						AND fact_billable_time_activity.source_system_id = fact_dimension_main_1.source_system_id
			 LEFT OUTER JOIN
             dim_client AS dim_client_1 ON dim_client_1.client_code = CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   (fact_billable_time_activity.dim_bill_key = 0)
AND (dim_orig_posting_date_key IS NOT NULL)
and     dim_orig_posting_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year BETWEEN  (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 7
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)	) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="d3340cb6-3b49-41f2-a013-ff9b9c647730">
          <ID>Fact Bill Activity great than 8 years old</ID>
          <Name>Fact Bill Activity great than 8 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="43ae0762-b984-43a5-abc8-c8a8c36086bb">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT CAST(fact_bill_activity.fact_bill_activity_key AS BIGINT) AS fact_bill_activity_key, fact_bill_activity.dim_client_key, fact_bill_activity.dim_bill_date_key, fact_bill_activity.dim_bill_key, fact_bill_activity.dim_fed_hierarchy_history_key, fact_bill_activity.dim_matter_header_curr_key, 
             fact_bill_activity.billed_time, fact_bill_activity.bill_amount, dim_days_banding.dim_days_banding_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key, bill_number, fact_bill_activity.source_system_id
FROM   fact_bill_activity INNER JOIN
             dim_days_banding ON DATEDIFF(d, GETDATE(), fact_bill_activity.gldate) BETWEEN dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
	left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_activity.master_fact_key
	LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
				CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE     dim_bill_date_key IN (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year &lt; (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' ))
AND dim_bill_date_key &gt;= '20100501'
 AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
UNION ALL


SELECT    CAST('999' + CAST(fact_billable_time_activity.source_system_id AS VARCHAR(2)) + CAST(fact_billable_time_activity.transaction_sequence_number AS VARCHAR(25)) AS bigint) AS EXPR1,
		fact_billable_time_activity.dim_client_key, fact_billable_time_activity.dim_orig_posting_date_key, fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_fed_hierarchy_history_key, 
             fact_billable_time_activity.dim_matter_header_curr_key, NULL AS EXPR2, NULL AS EXPR3, dim_days_banding_1.dim_days_banding_key, ISNULL(dim_client_1.client_code, 'Unknown') AS master_client_code, 
				ISNULL(fact_dimension_main_1.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, '0' AS EXPR4, fact_billable_time_activity.source_system_id
FROM     fact_billable_time_activity INNER JOIN
             dim_days_banding AS dim_days_banding_1 ON DATEDIFF(d, CAST(CONVERT(CHAR(10), fact_billable_time_activity.dim_orig_posting_date_key, 120) AS DATE), GETDATE()) BETWEEN dim_days_banding_1.startdays AND dim_days_banding_1.enddays AND dim_days_banding_1.banding_category = 'grouping3' 
			 LEFT outer JOIN
             fact_dimension_main AS fact_dimension_main_1 ON fact_dimension_main_1.dim_matter_header_curr_key = fact_billable_time_activity.dim_matter_header_curr_key
						AND fact_billable_time_activity.source_system_id = fact_dimension_main_1.source_system_id
			 LEFT OUTER JOIN
             dim_client AS dim_client_1 ON dim_client_1.client_code = CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
WHERE   (fact_billable_time_activity.dim_bill_key = 0)
AND (dim_orig_posting_date_key IS NOT NULL)
and     dim_orig_posting_date_key In (SELECT dim_date_key FROM dbo.dim_date WHERE fin_year &lt; (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' ))
AND dim_orig_posting_date_key &gt;= '20100501' AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
      <AggregationDesigns>
        <AggregationDesign>
          <ID>fact_bill_activity</ID>
          <Name>fact_bill_activity</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <Aggregations>
            <Aggregation>
              <ID>QueryLogAgg_0</ID>
              <Name>QueryLogAgg_0</Name>
              <Dimensions>
                <Dimension>
                  <CubeDimensionID>Client Details</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Sector</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Sub Sector</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Segment</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>Employees</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Hierarchylevel2hist</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
              </Dimensions>
            </Aggregation>
            <Aggregation>
              <ID>QueryLogAgg_1</ID>
              <Name>QueryLogAgg_1</Name>
              <Dimensions>
                <Dimension>
                  <CubeDimensionID>Bill Date</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Dim Date Key</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
              </Dimensions>
            </Aggregation>
            <Aggregation>
              <ID>QueryLogAgg_2</ID>
              <Name>QueryLogAgg_2</Name>
              <Dimensions>
                <Dimension>
                  <CubeDimensionID>Bill Date</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Dim Date Key</AttributeID>
                    </Attribute>
                    <Attribute>
                      <AttributeID>Date Age Group 2</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>Bill Details</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Dim Bill Key</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>Client Details</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Client Code</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>Employees</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Hierarchylevel2hist</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>Matter Details</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Dim Matter Header Curr Key</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>Master Client Details</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Dim Client Key</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
                <Dimension>
                  <CubeDimensionID>Employees 1</CubeDimensionID>
                  <Attributes>
                    <Attribute>
                      <AttributeID>Dim Fed Hierarchy History Key</AttributeID>
                    </Attribute>
                  </Attributes>
                </Dimension>
              </Dimensions>
            </Aggregation>
          </Aggregations>
        </AggregationDesign>
      </AggregationDesigns>
    </MeasureGroup>
    <MeasureGroup>
      <ID>Fact Budget Activity</ID>
      <Partitions>
        <Partition dwd:design-time-name="281d0bc9-473b-4b7f-b54b-2b5e01712c3c">
          <ID>Fact Budget Activity</ID>
          <Name>Fact Budget Current</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="33d07956-c8e7-4a3b-bb02-d0f0f61e693e">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT *
from fact_budget_activity_finance_cube
WHERE     (dim_gl_date_key &gt;= 20190501)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="cc8df5dd-b0cb-4052-8eed-9543e672ea6f">
          <ID>Fact Budget Historical</ID>
          <Name>Fact Budget Historical</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="f731789f-c504-4051-a8a5-2fbb769ee101">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT *
from fact_budget_activity_finance_cube

WHERE     dim_gl_date_key &gt;= 20100501
 and dim_gl_date_key &lt; 20190501</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
    </MeasureGroup>
    <MeasureGroup>
      <ID>Fact Wip</ID>
      <Partitions>
        <Partition dwd:design-time-name="a2dbb9ac-9c83-4af7-9410-745e4756214b">
          <ID>Fact Wip</ID>
          <Name>Fact Wip 2020</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="b56b6af6-4b0d-495d-9096-965d3571f95f">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT        fact_wip_monthly.dim_transaction_date_key, fact_wip_monthly.dim_matter_header_history_key, ISNULL(fact_dimension_main.dim_matter_header_curr_key, 0) AS dim_matter_header_current_key, 
                         fact_wip_monthly.dim_fed_hierarchy_history_key, fact_wip_monthly.dim_days_banding_key, fact_wip_monthly.dim_fed_matter_owner_key, fact_wip_monthly.dim_client_key, fact_wip_monthly.source_system_id, 
                         fact_wip_monthly.client, fact_wip_monthly.matter, fact_wip_monthly.matter_owner, fact_wip_monthly.fee_earner_code, fact_wip_monthly.wip_minutes, fact_wip_monthly.wip_value, 
                         fact_wip_monthly.dim_transaction_date_key AS wip_date, 0 AS dim_bill_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM            fact_wip_monthly LEFT OUTER JOIN
                 fact_dimension_main ON fact_dimension_main.master_fact_key = fact_wip_monthly.master_fact_key
				 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
	
WHERE       fact_wip_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2020)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="4c6d6db5-ee0d-4aa7-b0e0-d3769823be98">
          <ID>Fact Wip Historical</ID>
          <Name>Fact Wip 2019</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="38e3c7fd-aaff-4fdc-911c-279437315d65">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT        fact_wip_monthly.dim_transaction_date_key, fact_wip_monthly.dim_matter_header_history_key, ISNULL(fact_dimension_main.dim_matter_header_curr_key, 0) AS dim_matter_header_current_key, 
                         fact_wip_monthly.dim_fed_hierarchy_history_key, fact_wip_monthly.dim_days_banding_key, fact_wip_monthly.dim_fed_matter_owner_key, fact_wip_monthly.dim_client_key, fact_wip_monthly.source_system_id, 
                         fact_wip_monthly.client, fact_wip_monthly.matter, fact_wip_monthly.matter_owner, fact_wip_monthly.fee_earner_code, fact_wip_monthly.wip_minutes, fact_wip_monthly.wip_value, 
                         fact_wip_monthly.dim_transaction_date_key AS wip_date, 0 AS dim_bill_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM            fact_wip_monthly LEFT OUTER JOIN
                 fact_dimension_main ON fact_dimension_main.master_fact_key = fact_wip_monthly.master_fact_key
				 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
	
WHERE       fact_wip_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2019)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="a6d31efb-d9c1-4f28-a1af-1cabc084dbca">
          <ID>Fact Wip 2021</ID>
          <Name>Fact Wip 2021</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="37ba9c43-62d8-4126-a76f-55333a1aa360">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT        fact_wip_monthly.dim_transaction_date_key, fact_wip_monthly.dim_matter_header_history_key, ISNULL(fact_dimension_main.dim_matter_header_curr_key, 0) AS dim_matter_header_current_key, 
                         fact_wip_monthly.dim_fed_hierarchy_history_key, fact_wip_monthly.dim_days_banding_key, fact_wip_monthly.dim_fed_matter_owner_key, fact_wip_monthly.dim_client_key, fact_wip_monthly.source_system_id, 
                         fact_wip_monthly.client, fact_wip_monthly.matter, fact_wip_monthly.matter_owner, fact_wip_monthly.fee_earner_code, fact_wip_monthly.wip_minutes, fact_wip_monthly.wip_value, 
                         fact_wip_monthly.dim_transaction_date_key AS wip_date, 0 AS dim_bill_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM            fact_wip_monthly LEFT OUTER JOIN
                 fact_dimension_main ON fact_dimension_main.master_fact_key = fact_wip_monthly.master_fact_key
				 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
	
WHERE       fact_wip_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2021)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="ff8fbca0-c0d0-433f-aea9-aa43d2e4fbfe">
          <ID>Fact Wip 2022</ID>
          <Name>Fact Wip 2022</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="91d21c6c-695e-45bd-bc24-3adb4f3bd1d3">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT        fact_wip_monthly.dim_transaction_date_key, fact_wip_monthly.dim_matter_header_history_key, ISNULL(fact_dimension_main.dim_matter_header_curr_key, 0) AS dim_matter_header_current_key, 
                         fact_wip_monthly.dim_fed_hierarchy_history_key, fact_wip_monthly.dim_days_banding_key, fact_wip_monthly.dim_fed_matter_owner_key, fact_wip_monthly.dim_client_key, fact_wip_monthly.source_system_id, 
                         fact_wip_monthly.client, fact_wip_monthly.matter, fact_wip_monthly.matter_owner, fact_wip_monthly.fee_earner_code, fact_wip_monthly.wip_minutes, fact_wip_monthly.wip_value, 
                         fact_wip_monthly.dim_transaction_date_key AS wip_date, 0 AS dim_bill_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM            fact_wip_monthly LEFT OUTER JOIN
                 fact_dimension_main ON fact_dimension_main.master_fact_key = fact_wip_monthly.master_fact_key
				 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
	
WHERE       fact_wip_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2022)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="de480892-0d78-42d7-8b9f-c10dc82c468c">
          <ID>Fact Wip 2023</ID>
          <Name>Fact Wip 2023</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="f876bbf2-71ff-400d-94ab-9ecb3407fb4d">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT        fact_wip_monthly.dim_transaction_date_key, fact_wip_monthly.dim_matter_header_history_key, ISNULL(fact_dimension_main.dim_matter_header_curr_key, 0) AS dim_matter_header_current_key, 
                         fact_wip_monthly.dim_fed_hierarchy_history_key, fact_wip_monthly.dim_days_banding_key, fact_wip_monthly.dim_fed_matter_owner_key, fact_wip_monthly.dim_client_key, fact_wip_monthly.source_system_id, 
                         fact_wip_monthly.client, fact_wip_monthly.matter, fact_wip_monthly.matter_owner, fact_wip_monthly.fee_earner_code, fact_wip_monthly.wip_minutes, fact_wip_monthly.wip_value, 
                         fact_wip_monthly.dim_transaction_date_key AS wip_date, 0 AS dim_bill_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code
FROM            fact_wip_monthly LEFT OUTER JOIN
                 fact_dimension_main ON fact_dimension_main.master_fact_key = fact_wip_monthly.master_fact_key
				 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
	
WHERE       fact_wip_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2023)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
    </MeasureGroup>
    <MeasureGroup>
      <ID>Fact Bill Billed Time Activity</ID>
      <Partitions>
        <Partition dwd:design-time-name="baac4f7e-b8ae-4cac-8329-0008e289681d">
          <ID>Fact Bill Billed Time Activity</ID>
          <Name>Fact Bill Billed Time Activity Current</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="afa4919d-4f07-4fc1-9078-133e275fb2f4">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key,ISNULL(dim_client.client_code, 'Unknown') master_client_code,
			  SUM(minutes_recorded) minutes_recorded, fact_bill_billed_time_activity.source_system_id
FROM         fact_bill_billed_time_activity
INNER JOIN dim_date ON dim_date.dim_date_key = fact_bill_billed_time_activity.dim_gl_date_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_gl_date_key, 120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_billed_time_activity.master_fact_key
LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END	
WHERE  current_fin_year = 'Current' AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
GROUP BY  dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, dbo.fact_dimension_main.dim_fed_hierarchy_history_key, ISNULL(dim_client.client_code, 'Unknown'), fact_bill_billed_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="09df9c61-1058-44ba-9c6c-5c12b41dd3ce">
          <ID>Fact Bill Billed Time Activity 1</ID>
          <Name>Fact Bill Billed Time 1 and 2 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="cbb9f00c-0c45-46e5-816b-ac1c4d4a4c0e">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key,ISNULL(dim_client.client_code, 'Unknown') master_client_code,
			  SUM(minutes_recorded) minutes_recorded, fact_bill_billed_time_activity.source_system_id
FROM         fact_bill_billed_time_activity
INNER JOIN dim_date ON dim_date.dim_date_key = fact_bill_billed_time_activity.dim_gl_date_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_gl_date_key, 120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_billed_time_activity.master_fact_key
LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END	
WHERE fin_year BETWEEN (SELECT DISTINCT fin_year - 2
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 1
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)  AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1	
GROUP BY  dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, dbo.fact_dimension_main.dim_fed_hierarchy_history_key, ISNULL(dim_client.client_code, 'Unknown'), fact_bill_billed_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="25f7ee65-37a4-407e-b441-383cab7b53a5">
          <ID>Fact Bill Billed Time Activity 3 and 4 years old</ID>
          <Name>Fact Bill Billed Time 3 and 4 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="5345144c-58f1-4624-905d-6b50ad8db9b4">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key,ISNULL(dim_client.client_code, 'Unknown') master_client_code,
			  SUM(minutes_recorded) minutes_recorded, fact_bill_billed_time_activity.source_system_id
FROM         fact_bill_billed_time_activity
INNER JOIN dim_date ON dim_date.dim_date_key = fact_bill_billed_time_activity.dim_gl_date_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_gl_date_key, 120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_billed_time_activity.master_fact_key
LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END	
WHERE fin_year BETWEEN (SELECT DISTINCT fin_year - 4
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 3
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1	
GROUP BY  dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, dbo.fact_dimension_main.dim_fed_hierarchy_history_key, ISNULL(dim_client.client_code, 'Unknown'), fact_bill_billed_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="61879424-f17b-497f-b2d8-2608ddcd56af">
          <ID>Fact Bill Billed Time 5 and 6 years old</ID>
          <Name>Fact Bill Billed Time 5 and 6 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="1a25cc96-5825-4298-af87-88ba765388d9">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key,ISNULL(dim_client.client_code, 'Unknown') master_client_code,
			  SUM(minutes_recorded) minutes_recorded, fact_bill_billed_time_activity.source_system_id
FROM         fact_bill_billed_time_activity
INNER JOIN dim_date ON dim_date.dim_date_key = fact_bill_billed_time_activity.dim_gl_date_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_gl_date_key, 120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_billed_time_activity.master_fact_key
LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END	
WHERE fin_year BETWEEN (SELECT DISTINCT fin_year - 6
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 5
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1	
GROUP BY  dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, dbo.fact_dimension_main.dim_fed_hierarchy_history_key, ISNULL(dim_client.client_code, 'Unknown'), fact_bill_billed_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="5a9b87ae-08d8-4aac-9874-73c051303761">
          <ID>Fact Bill Billed Time 7 and 8 years old</ID>
          <Name>Fact Bill Billed Time 7 and 8 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="c237d1c7-d5f3-4d5a-8f7e-1c48b7ad6288">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key,ISNULL(dim_client.client_code, 'Unknown') master_client_code,
			  SUM(minutes_recorded) minutes_recorded, fact_bill_billed_time_activity.source_system_id
FROM         fact_bill_billed_time_activity
INNER JOIN dim_date ON dim_date.dim_date_key = fact_bill_billed_time_activity.dim_gl_date_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_gl_date_key, 120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_billed_time_activity.master_fact_key
LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END	
WHERE fin_year BETWEEN (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 7
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1	
GROUP BY  dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, dbo.fact_dimension_main.dim_fed_hierarchy_history_key, ISNULL(dim_client.client_code, 'Unknown'), fact_bill_billed_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="7c54c611-f7f4-4376-8108-d183b6b416af">
          <ID>Fact Bill Billed Time great than 8 years old</ID>
          <Name>Fact Bill Billed Time great than 8 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="fbc63bf0-c3cd-45d2-9f27-9ecf299a3b9a">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) matter_owner_hist_key,ISNULL(dim_client.client_code, 'Unknown') master_client_code,
			  SUM(minutes_recorded) minutes_recorded, fact_bill_billed_time_activity.source_system_id
FROM         fact_bill_billed_time_activity
INNER JOIN dim_date ON dim_date.dim_date_key = fact_bill_billed_time_activity.dim_gl_date_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_gl_date_key, 120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
left outer JOIN dbo.fact_dimension_main ON fact_dimension_main.master_fact_key = fact_bill_billed_time_activity.master_fact_key
LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END	
WHERE fin_year &lt; (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' ) 
AND  (fact_bill_billed_time_activity.dim_gl_date_key &gt;= 20100501) AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
GROUP BY  dim_bill_key, fact_bill_billed_time_activity.dim_client_key, dim_transaction_date_key, fact_bill_billed_time_activity.dim_fed_hierarchy_history_key, 
	fact_bill_billed_time_activity.dim_matter_header_curr_key, dim_gl_date_key, 
              dim_days_banding_key, dbo.fact_dimension_main.dim_fed_hierarchy_history_key, ISNULL(dim_client.client_code, 'Unknown'), fact_bill_billed_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
    </MeasureGroup>
    <MeasureGroup>
      <ID>Fact Billable Time Activity</ID>
      <Partitions>
        <Partition dwd:design-time-name="faa4ea9a-746f-4645-a5f7-1b0c2bc817c2">
          <ID>Fact Billable Time Activity</ID>
          <Name>Fact Billable Time Activity Current</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="1ef08370-1993-4875-96f6-c0c951b6d1cc">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0) AS matter_owner_history_key, dim_days_banding_key,
							SUM(minutes_recorded) minutes_recorded, SUM(fact_billable_time_activity.minutes_recorded / 60) AS chargeable_hours
							,  ISNULL(dim_client.client_code, 'Unknown') master_client_code
,staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min			 ,staff_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_staff_cost_rate
			 ,other_costs_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_other_cost_rate
			 ,total_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_total_cost_rate ,establishment_cost_rate * SUM((fact_billable_time_activity.minutes_recorded / 60)) AS chargeable_hours_establishment_cost_rate,fact_billable_time_activity.source_system_id
FROM         fact_billable_time_activity LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_billable_time_activity.master_fact_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_orig_posting_date_key,120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
INNER JOIN dim_date ON dim_date.dim_date_key = fact_billable_time_activity.dim_orig_posting_date_key
 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END 	LEFT OUTER JOIN dbo.dim_fed_hierarchy_history ON dim_fed_hierarchy_history.dim_fed_hierarchy_history_key = fact_billable_time_activity.dim_fed_hierarchy_history_key	
	LEFT OUTER JOIN dbo.fact_costs_rates ON fact_costs_rates.dim_employee_key = dim_fed_hierarchy_history.dim_employee_key
	AND fact_costs_rates.fin_year = dim_date.fin_year AND fact_costs_rates.fin_month_no = dim_date.fin_month_no
WHERE (fact_billable_time_activity.minutes_recorded &lt;&gt; 0)
AND current_fin_year = 'Current'
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
GROUP BY  fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0), dim_days_banding_key,  ISNULL(dim_client.client_code, 'Unknown'),staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min, establishment_cost_rate,fact_billable_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="1f6e2596-08a1-4b9f-99c9-d0bc824b8767">
          <ID>Fact Billable Time Activity Historical</ID>
          <Name>Fact Billable Time 1 and 2 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="70b8f73e-89a3-484a-9171-70a0619bba5a">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0) AS matter_owner_history_key, dim_days_banding_key,
							SUM(minutes_recorded) minutes_recorded, SUM(fact_billable_time_activity.minutes_recorded / 60) AS chargeable_hours
							,  ISNULL(dim_client.client_code, 'Unknown') master_client_code
,staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min
			 ,staff_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_staff_cost_rate
			 ,other_costs_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_other_cost_rate
			 ,total_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_total_cost_rate			 ,establishment_cost_rate * SUM((fact_billable_time_activity.minutes_recorded / 60)) AS chargeable_hours_establishment_cost_rate,fact_billable_time_activity.source_system_id
FROM         fact_billable_time_activity LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_billable_time_activity.master_fact_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_orig_posting_date_key,120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
INNER JOIN dim_date ON dim_date.dim_date_key = fact_billable_time_activity.dim_orig_posting_date_key
 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END 	LEFT OUTER JOIN dbo.dim_fed_hierarchy_history ON dim_fed_hierarchy_history.dim_fed_hierarchy_history_key = fact_billable_time_activity.dim_fed_hierarchy_history_key	
	LEFT OUTER JOIN dbo.fact_costs_rates ON fact_costs_rates.dim_employee_key = dim_fed_hierarchy_history.dim_employee_key
	AND fact_costs_rates.fin_year = dim_date.fin_year AND fact_costs_rates.fin_month_no = dim_date.fin_month_no
WHERE (fact_billable_time_activity.minutes_recorded &lt;&gt; 0)
and dim_date.fin_year BETWEEN (SELECT DISTINCT fin_year - 2
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 1
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
GROUP BY  fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0), dim_days_banding_key,  ISNULL(dim_client.client_code, 'Unknown'),staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min, establishment_cost_rate,fact_billable_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="72a1fde8-7ecc-409a-a806-80d5fee2a35c">
          <ID>Fact Billable Time 2 and 3 years old</ID>
          <Name>Fact Billable Time 3 and 4 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="75cfaca8-91a1-4be8-84da-f8a2ea326a11">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0) AS matter_owner_history_key, dim_days_banding_key,
							SUM(minutes_recorded) minutes_recorded, SUM(fact_billable_time_activity.minutes_recorded / 60) AS chargeable_hours
							,  ISNULL(dim_client.client_code, 'Unknown') master_client_code
,staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min
			 ,staff_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_staff_cost_rate
			 ,other_costs_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_other_cost_rate
			 ,total_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_total_cost_rate ,establishment_cost_rate * SUM((fact_billable_time_activity.minutes_recorded / 60)) AS chargeable_hours_establishment_cost_rate,fact_billable_time_activity.source_system_id
FROM         fact_billable_time_activity LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_billable_time_activity.master_fact_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_orig_posting_date_key,120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
INNER JOIN dim_date ON dim_date.dim_date_key = fact_billable_time_activity.dim_orig_posting_date_key
 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END 	LEFT OUTER JOIN dbo.dim_fed_hierarchy_history ON dim_fed_hierarchy_history.dim_fed_hierarchy_history_key = fact_billable_time_activity.dim_fed_hierarchy_history_key	
	LEFT OUTER JOIN dbo.fact_costs_rates ON fact_costs_rates.dim_employee_key = dim_fed_hierarchy_history.dim_employee_key
	AND fact_costs_rates.fin_year = dim_date.fin_year AND fact_costs_rates.fin_month_no = dim_date.fin_month_no
WHERE (fact_billable_time_activity.minutes_recorded &lt;&gt; 0)
and dim_date.fin_year BETWEEN (SELECT DISTINCT fin_year - 4
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 3
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
GROUP BY  fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0), dim_days_banding_key,  ISNULL(dim_client.client_code, 'Unknown'),staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min, establishment_cost_rate,fact_billable_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="20f81016-9870-495c-8da6-2fadffe1e1ee">
          <ID>Fact Billable Time 5 and 6 years old</ID>
          <Name>Fact Billable Time 5 and 6 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="2ba7c5a2-816b-4694-87ca-fc30019459b8">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0) AS matter_owner_history_key, dim_days_banding_key,
							SUM(minutes_recorded) minutes_recorded, SUM(fact_billable_time_activity.minutes_recorded / 60) AS chargeable_hours
							,  ISNULL(dim_client.client_code, 'Unknown') master_client_code
			 ,staff_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_staff_cost_rate
			 ,other_costs_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_other_cost_rate
			 ,total_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_total_cost_rate
,staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min ,establishment_cost_rate * SUM((fact_billable_time_activity.minutes_recorded / 60)) AS chargeable_hours_establishment_cost_rate,fact_billable_time_activity.source_system_id
FROM         fact_billable_time_activity LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_billable_time_activity.master_fact_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_orig_posting_date_key,120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
INNER JOIN dim_date ON dim_date.dim_date_key = fact_billable_time_activity.dim_orig_posting_date_key
 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END 	LEFT OUTER JOIN dbo.dim_fed_hierarchy_history ON dim_fed_hierarchy_history.dim_fed_hierarchy_history_key = fact_billable_time_activity.dim_fed_hierarchy_history_key	
	LEFT OUTER JOIN dbo.fact_costs_rates ON fact_costs_rates.dim_employee_key = dim_fed_hierarchy_history.dim_employee_key
	AND fact_costs_rates.fin_year = dim_date.fin_year AND fact_costs_rates.fin_month_no = dim_date.fin_month_no
WHERE (fact_billable_time_activity.minutes_recorded &lt;&gt; 0)
and dim_date.fin_year BETWEEN (SELECT DISTINCT fin_year - 6
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 5
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
GROUP BY  fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0), dim_days_banding_key,  ISNULL(dim_client.client_code, 'Unknown'),staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min, establishment_cost_rate,fact_billable_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="f1a3d69e-9135-4a25-bd73-699c22719fe0">
          <ID>Fact Billable Time 7 and 8 years old</ID>
          <Name>Fact Billable Time 7 and 8 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="76abd359-fed7-44a7-a7b3-683b3e563a85">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0) AS matter_owner_history_key, dim_days_banding_key,
							SUM(minutes_recorded) minutes_recorded, SUM(fact_billable_time_activity.minutes_recorded / 60) AS chargeable_hours
							,  ISNULL(dim_client.client_code, 'Unknown') master_client_code
,staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min
			 ,staff_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_staff_cost_rate
			 ,other_costs_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_other_cost_rate
			 ,total_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_total_cost_rate ,establishment_cost_rate * SUM((fact_billable_time_activity.minutes_recorded / 60)) AS chargeable_hours_establishment_cost_rate,fact_billable_time_activity.source_system_id
FROM         fact_billable_time_activity LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_billable_time_activity.master_fact_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_orig_posting_date_key,120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
INNER JOIN dim_date ON dim_date.dim_date_key = fact_billable_time_activity.dim_orig_posting_date_key
 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END 	LEFT OUTER JOIN dbo.dim_fed_hierarchy_history ON dim_fed_hierarchy_history.dim_fed_hierarchy_history_key = fact_billable_time_activity.dim_fed_hierarchy_history_key	
	LEFT OUTER JOIN dbo.fact_costs_rates ON fact_costs_rates.dim_employee_key = dim_fed_hierarchy_history.dim_employee_key
	AND fact_costs_rates.fin_year = dim_date.fin_year AND fact_costs_rates.fin_month_no = dim_date.fin_month_no
WHERE (fact_billable_time_activity.minutes_recorded &lt;&gt; 0)
and dim_date.fin_year BETWEEN (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND   (SELECT DISTINCT fin_year - 7
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current'		)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
GROUP BY  fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0), dim_days_banding_key,  ISNULL(dim_client.client_code, 'Unknown'),staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min, establishment_cost_rate,fact_billable_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="b2f3bca3-2e97-41c6-88d0-30e7bd7ab830">
          <ID>Fact Billable Time greater than 8 years old</ID>
          <Name>Fact Billable Time greater than 8 years old</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="835dc833-3d0e-41e2-bc65-ad7b7074628d">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0) AS matter_owner_history_key, dim_days_banding_key,
							SUM(minutes_recorded) minutes_recorded, SUM(fact_billable_time_activity.minutes_recorded / 60) AS chargeable_hours
							,  ISNULL(dim_client.client_code, 'Unknown') master_client_code
,staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min
			 ,staff_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_staff_cost_rate
			 ,other_costs_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_other_cost_rate
			 ,total_cost_rate * SUM(fact_billable_time_activity.minutes_recorded / 60) chargeable_hours_total_cost_rate ,establishment_cost_rate * SUM((fact_billable_time_activity.minutes_recorded / 60)) AS chargeable_hours_establishment_cost_rate,fact_billable_time_activity.source_system_id
FROM         fact_billable_time_activity LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_billable_time_activity.master_fact_key
INNER join dim_days_banding on DATEDIFF(d, CAST(CONVERT(CHAR(10), dim_orig_posting_date_key,120) AS DATE), GETDATE()) BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
INNER JOIN dim_date ON dim_date.dim_date_key = fact_billable_time_activity.dim_orig_posting_date_key
 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
			CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END 	LEFT OUTER JOIN dbo.dim_fed_hierarchy_history ON dim_fed_hierarchy_history.dim_fed_hierarchy_history_key = fact_billable_time_activity.dim_fed_hierarchy_history_key	
	LEFT OUTER JOIN dbo.fact_costs_rates ON fact_costs_rates.dim_employee_key = dim_fed_hierarchy_history.dim_employee_key
	AND fact_costs_rates.fin_year = dim_date.fin_year AND fact_costs_rates.fin_month_no = dim_date.fin_month_no
WHERE (fact_billable_time_activity.minutes_recorded &lt;&gt; 0)
and dim_date.fin_year &lt; (SELECT DISTINCT fin_year - 8
					FROM dbo.dim_date
					WHERE current_fin_year = 'Current' )  AND (fact_billable_time_activity.dim_orig_posting_date_key &gt;= 20100501)
AND ISNULL(finance_reporting_exclusion,'') &lt;&gt; 1
GROUP BY  fact_billable_time_activity.dim_bill_key, fact_billable_time_activity.dim_client_key, 
                         fact_billable_time_activity.dim_fed_hierarchy_history_key, fact_billable_time_activity.dim_matter_header_curr_key, fact_billable_time_activity.master_fact_key,                        
                         fact_billable_time_activity.dim_orig_posting_date_key,  ISNULL(fact_dimension_main.dim_fed_hierarchy_history_key, 0), dim_days_banding_key,  ISNULL(dim_client.client_code, 'Unknown'),staff_cost_rate, staff_cost_rate_per_min, other_costs_rate, other_costs_rate_per_min, total_cost_rate, total_cost_rate_per_min, establishment_cost_rate,fact_billable_time_activity.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
    </MeasureGroup>
    <MeasureGroup>
      <ID>Fact Debt Monthly</ID>
      <Partitions>
        <Partition dwd:design-time-name="fa91ee92-6a85-41fc-81f6-830214c32aba">
          <ID>Fact Debt Monthly</ID>
          <Name>Fact Debt Monthly 2020</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="d887d1b9-d0e3-4d4c-b3b1-ba62aaa86a18">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_debt_monthly.dim_transaction_date_key, fact_debt_monthly.dim_mat_head_history_key, fact_debt_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_dimension_main.dim_fed_hierarchy_history_key, fact_debt_monthly.dim_days_banding_key, fact_debt_monthly.dim_fed_matter_owner_key, fact_debt_monthly.dim_client_key, 
                         fact_debt_monthly.source_system_id, fact_debt_monthly.client_code, fact_debt_monthly.matter_number, fact_debt_monthly.matter_owner, fact_debt_monthly.bill_number, 
                         fact_debt_monthly.bill_date, fact_debt_monthly.outstanding_total_bill, fact_debt_monthly.outstanding_costs, fact_debt_monthly.age_of_debt, fact_debt_monthly.debt_date, 
                         fact_debt_monthly.dim_bill_key, dim_debt_date.dim_date_key AS dim_debt_date_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, billdate.dim_date_key AS bill_date_key
FROM         fact_debt_monthly LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_debt_monthly.master_fact_key
						 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS dim_debt_date ON dim_debt_date.calendar_date = CAST(fact_debt_monthly.debt_date AS DATE) INNER JOIN
                         dim_date AS billdate ON billdate.calendar_date = CAST(CASE WHEN fact_debt_monthly.bill_date &lt; '20100501' THEN '20100501' ELSE fact_debt_monthly.bill_date END AS DATE)
WHERE          fact_debt_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2020)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="907be86f-a6eb-4f13-b0a0-3ab8ef9ddd87">
          <ID>Fact Debt Monthly 1</ID>
          <Name>Fact Debt Monthly 2019</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="18cf8124-8781-4d6a-8c15-e528f3f766fa">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_debt_monthly.dim_transaction_date_key, fact_debt_monthly.dim_mat_head_history_key, fact_debt_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_dimension_main.dim_fed_hierarchy_history_key, fact_debt_monthly.dim_days_banding_key, fact_debt_monthly.dim_fed_matter_owner_key, fact_debt_monthly.dim_client_key, 
                         fact_debt_monthly.source_system_id, fact_debt_monthly.client_code, fact_debt_monthly.matter_number, fact_debt_monthly.matter_owner, fact_debt_monthly.bill_number, 
                         fact_debt_monthly.bill_date, fact_debt_monthly.outstanding_total_bill, fact_debt_monthly.outstanding_costs, fact_debt_monthly.age_of_debt, fact_debt_monthly.debt_date, 
                         fact_debt_monthly.dim_bill_key, dim_debt_date.dim_date_key AS dim_debt_date_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, billdate.dim_date_key AS bill_date_key
FROM         fact_debt_monthly LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_debt_monthly.master_fact_key
						 LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS dim_debt_date ON dim_debt_date.calendar_date = CAST(fact_debt_monthly.debt_date AS DATE) INNER JOIN
                         dim_date AS billdate ON billdate.calendar_date = CAST(CASE WHEN fact_debt_monthly.bill_date &lt; '20100501' THEN '20100501' ELSE fact_debt_monthly.bill_date END AS DATE)
WHERE          fact_debt_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2019)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="aaa95400-e207-4cff-8f20-4613ac0030e4">
          <ID>Fact Debt Monthly 2021</ID>
          <Name>Fact Debt Monthly 2021</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="53282ff8-aaa2-469d-a121-811cb585cef9">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_debt_monthly.dim_transaction_date_key, fact_debt_monthly.dim_mat_head_history_key, fact_debt_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_dimension_main.dim_fed_hierarchy_history_key, fact_debt_monthly.dim_days_banding_key, fact_debt_monthly.dim_fed_matter_owner_key, fact_debt_monthly.dim_client_key, 
                         fact_debt_monthly.source_system_id, fact_debt_monthly.client_code, fact_debt_monthly.matter_number, fact_debt_monthly.matter_owner, fact_debt_monthly.bill_number, 
                         fact_debt_monthly.bill_date, fact_debt_monthly.outstanding_total_bill, fact_debt_monthly.outstanding_costs, fact_debt_monthly.age_of_debt, fact_debt_monthly.debt_date, 
                         fact_debt_monthly.dim_bill_key, dim_debt_date.dim_date_key AS dim_debt_date_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, billdate.dim_date_key AS bill_date_key
FROM         fact_debt_monthly LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_debt_monthly.master_fact_key
						LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS dim_debt_date ON dim_debt_date.calendar_date = CAST(fact_debt_monthly.debt_date AS DATE) INNER JOIN
                         dim_date AS billdate ON billdate.calendar_date = CAST(CASE WHEN fact_debt_monthly.bill_date &lt; '20100501' THEN '20100501' ELSE fact_debt_monthly.bill_date END AS DATE)
WHERE          fact_debt_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2021)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="aac6c570-1cfc-4c4a-b405-514f034298d5">
          <ID>Fact Debt Monthly 2022</ID>
          <Name>Fact Debt Monthly 2022</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="f107a7e4-1319-4fa4-853e-0ac4c205e213">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_debt_monthly.dim_transaction_date_key, fact_debt_monthly.dim_mat_head_history_key, fact_debt_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_dimension_main.dim_fed_hierarchy_history_key, fact_debt_monthly.dim_days_banding_key, fact_debt_monthly.dim_fed_matter_owner_key, fact_debt_monthly.dim_client_key, 
                         fact_debt_monthly.source_system_id, fact_debt_monthly.client_code, fact_debt_monthly.matter_number, fact_debt_monthly.matter_owner, fact_debt_monthly.bill_number, 
                         fact_debt_monthly.bill_date, fact_debt_monthly.outstanding_total_bill, fact_debt_monthly.outstanding_costs, fact_debt_monthly.age_of_debt, fact_debt_monthly.debt_date, 
                         fact_debt_monthly.dim_bill_key, dim_debt_date.dim_date_key AS dim_debt_date_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, billdate.dim_date_key AS bill_date_key
FROM         fact_debt_monthly LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_debt_monthly.master_fact_key
						LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS dim_debt_date ON dim_debt_date.calendar_date = CAST(fact_debt_monthly.debt_date AS DATE) INNER JOIN
                         dim_date AS billdate ON billdate.calendar_date = CAST(CASE WHEN fact_debt_monthly.bill_date &lt; '20100501' THEN '20100501' ELSE fact_debt_monthly.bill_date END AS DATE)
WHERE          fact_debt_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2022)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="a74d179d-e4c8-4f9a-88f4-4402485ccb2a">
          <ID>Fact Debt Monthly 2023</ID>
          <Name>Fact Debt Monthly 2023</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="6ed3e430-8a28-478b-a5c7-fbf521cc10ab">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_debt_monthly.dim_transaction_date_key, fact_debt_monthly.dim_mat_head_history_key, fact_debt_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_dimension_main.dim_fed_hierarchy_history_key, fact_debt_monthly.dim_days_banding_key, fact_debt_monthly.dim_fed_matter_owner_key, fact_debt_monthly.dim_client_key, 
                         fact_debt_monthly.source_system_id, fact_debt_monthly.client_code, fact_debt_monthly.matter_number, fact_debt_monthly.matter_owner, fact_debt_monthly.bill_number, 
                         fact_debt_monthly.bill_date, fact_debt_monthly.outstanding_total_bill, fact_debt_monthly.outstanding_costs, fact_debt_monthly.age_of_debt, fact_debt_monthly.debt_date, 
                         fact_debt_monthly.dim_bill_key, dim_debt_date.dim_date_key AS dim_debt_date_key, ISNULL(dim_client.client_code, 'Unknown') master_client_code, billdate.dim_date_key AS bill_date_key
FROM         fact_debt_monthly LEFT OUTER JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_debt_monthly.master_fact_key
		LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS dim_debt_date ON dim_debt_date.calendar_date = CAST(fact_debt_monthly.debt_date AS DATE) INNER JOIN
                         dim_date AS billdate ON billdate.calendar_date = CAST(CASE WHEN fact_debt_monthly.bill_date &lt; '20100501' THEN '20100501' ELSE fact_debt_monthly.bill_date END AS DATE)
WHERE          fact_debt_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2023)</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
      <AggregationDesigns>
        <AggregationDesign>
          <ID>AggregationDesign</ID>
          <Name>AggregationDesign</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <EstimatedRows>211640</EstimatedRows>
          <Dimensions>
            <Dimension>
              <CubeDimensionID>Bill Details</CubeDimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>Dim Bill Key</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <CubeDimensionID>Matter Details</CubeDimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>Dim Matter Header Curr Key</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <CubeDimensionID>Client Details</CubeDimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>Client Code</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <CubeDimensionID>Bill Date</CubeDimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>Dim Date Key</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <CubeDimensionID>Age Banding</CubeDimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>Age Banding</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <CubeDimensionID>Employees 1</CubeDimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>Dim Fed Hierarchy History Key</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
            <Dimension>
              <CubeDimensionID>Dibs WIP and Debt Snapshot</CubeDimensionID>
              <Attributes>
                <Attribute>
                  <AttributeID>Snapshot Date</AttributeID>
                </Attribute>
              </Attributes>
            </Dimension>
          </Dimensions>
        </AggregationDesign>
      </AggregationDesigns>
    </MeasureGroup>
    <MeasureGroup>
      <ID>Fact Disbursements Detail Monthly</ID>
      <Partitions>
        <Partition dwd:design-time-name="c7e16532-37cd-4e1d-89dc-3594a7988b75">
          <ID>Fact Disbursements Detail Monthly</ID>
          <Name>Fact Disbursements Detail Monthly 2019</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="e9dad520-e67f-4bf4-8fa2-e52b6c91f180">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_disbursements_detail_monthly.dim_transaction_date_key, fact_disbursements_detail_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, fact_disbursements_detail_monthly.dim_client_key, 
                         CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END AS dim_disbursement_date_key, 
                         SUM(fact_disbursements_detail_monthly.total_unbilled_disbursements) AS total_unbilled_disbursements, fact_disbursements_detail_monthly.dim_bill_key, 
                       ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, fact_disbursements_detail_monthly.source_system_id
FROM         fact_disbursements_detail_monthly left outer JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_disbursements_detail_monthly.master_fact_key 
		LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS trandate ON trandate.dim_date_key = fact_disbursements_detail_monthly.dim_transaction_date_key INNER JOIN
                         dim_days_banding ON CASE WHEN dim_transaction_date_key =
                             (SELECT   MAX(dim_transaction_date_key)
                                FROM         fact_disbursements_detail_monthly) THEN DATEDIFF(d, workdate, GETDATE()) ELSE DATEDIFF(d, workdate, trandate.calendar_date) END BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
WHERE   (fact_disbursements_detail_monthly.dim_bill_key = 0) AND (fact_disbursements_detail_monthly.total_unbilled_disbursements &lt;&gt; 0)
and          fact_disbursements_detail_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2019)

GROUP BY CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END, fact_disbursements_detail_monthly.dim_transaction_date_key, 
                         fact_disbursements_detail_monthly.dim_matter_header_curr_key, fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, 
                         fact_disbursements_detail_monthly.dim_client_key, fact_disbursements_detail_monthly.dim_bill_key, fact_dimension_main.master_client_code, fact_dimension_main.dim_fed_hierarchy_history_key ,   ISNULL(dim_client.client_code, 'Unknown'), fact_dimension_main.client_code, fact_disbursements_detail_monthly.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="7c802631-4ba8-4a2a-8ff9-a44333bc5936">
          <ID>Fact Disbursements Detail Monthly Historical</ID>
          <Name>Fact Disbursements Detail Monthly 2020</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="b698769c-d909-4da1-ad67-aea268d578d8">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_disbursements_detail_monthly.dim_transaction_date_key, fact_disbursements_detail_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, fact_disbursements_detail_monthly.dim_client_key, 
                         CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END AS dim_disbursement_date_key, 
                         SUM(fact_disbursements_detail_monthly.total_unbilled_disbursements) AS total_unbilled_disbursements, fact_disbursements_detail_monthly.dim_bill_key, 
                       ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, fact_disbursements_detail_monthly.source_system_id
FROM         fact_disbursements_detail_monthly left outer JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_disbursements_detail_monthly.master_fact_key 
	LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS trandate ON trandate.dim_date_key = fact_disbursements_detail_monthly.dim_transaction_date_key INNER JOIN
                         dim_days_banding ON CASE WHEN dim_transaction_date_key =
                             (SELECT   MAX(dim_transaction_date_key)
                                FROM         fact_disbursements_detail_monthly) THEN DATEDIFF(d, workdate, GETDATE()) ELSE DATEDIFF(d, workdate, trandate.calendar_date) END BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
WHERE   (fact_disbursements_detail_monthly.dim_bill_key = 0) AND (fact_disbursements_detail_monthly.total_unbilled_disbursements &lt;&gt; 0)
and          fact_disbursements_detail_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2020)

GROUP BY CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END, fact_disbursements_detail_monthly.dim_transaction_date_key, 
                         fact_disbursements_detail_monthly.dim_matter_header_curr_key, fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, 
                         fact_disbursements_detail_monthly.dim_client_key, fact_disbursements_detail_monthly.dim_bill_key, fact_dimension_main.master_client_code, fact_dimension_main.dim_fed_hierarchy_history_key,  ISNULL(dim_client.client_code, 'Unknown'),  fact_dimension_main.client_code, fact_disbursements_detail_monthly.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="2c0111bd-2e01-48a7-b09f-811607f24df3">
          <ID>Fact Disbursements Detail Monthly 2021</ID>
          <Name>Fact Disbursements Detail Monthly 2021</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="c905b46e-5578-465b-b7f8-0a03c37e0a2f">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_disbursements_detail_monthly.dim_transaction_date_key, fact_disbursements_detail_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, fact_disbursements_detail_monthly.dim_client_key, 
                         CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END AS dim_disbursement_date_key, 
                         SUM(fact_disbursements_detail_monthly.total_unbilled_disbursements) AS total_unbilled_disbursements, fact_disbursements_detail_monthly.dim_bill_key, 
                       ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, fact_disbursements_detail_monthly.source_system_id
FROM         fact_disbursements_detail_monthly left outer JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_disbursements_detail_monthly.master_fact_key 
		LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS trandate ON trandate.dim_date_key = fact_disbursements_detail_monthly.dim_transaction_date_key INNER JOIN
                         dim_days_banding ON CASE WHEN dim_transaction_date_key =
                             (SELECT   MAX(dim_transaction_date_key)
                                FROM         fact_disbursements_detail_monthly) THEN DATEDIFF(d, workdate, GETDATE()) ELSE DATEDIFF(d, workdate, trandate.calendar_date) END BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
WHERE   (fact_disbursements_detail_monthly.dim_bill_key = 0) AND (fact_disbursements_detail_monthly.total_unbilled_disbursements &lt;&gt; 0)
and          fact_disbursements_detail_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2021)

GROUP BY CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END, fact_disbursements_detail_monthly.dim_transaction_date_key, 
                         fact_disbursements_detail_monthly.dim_matter_header_curr_key, fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, 
                         fact_disbursements_detail_monthly.dim_client_key, fact_disbursements_detail_monthly.dim_bill_key, ISNULL(dim_client.client_code, 'Unknown'), fact_dimension_main.dim_fed_hierarchy_history_key, fact_dimension_main.client_code, fact_disbursements_detail_monthly.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="21819caf-cb30-4bcd-bcaa-2a2a3b08b5c7">
          <ID>Fact Disbursements Detail Monthly 2022</ID>
          <Name>Fact Disbursements Detail Monthly 2022</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="d9c9bef7-167c-4be7-8f9d-1f18db9cf9cb">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_disbursements_detail_monthly.dim_transaction_date_key, fact_disbursements_detail_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, fact_disbursements_detail_monthly.dim_client_key, 
                         CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END AS dim_disbursement_date_key, 
                         SUM(fact_disbursements_detail_monthly.total_unbilled_disbursements) AS total_unbilled_disbursements, fact_disbursements_detail_monthly.dim_bill_key, 
                       ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, fact_disbursements_detail_monthly.source_system_id
FROM         fact_disbursements_detail_monthly left outer JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_disbursements_detail_monthly.master_fact_key 
		LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS trandate ON trandate.dim_date_key = fact_disbursements_detail_monthly.dim_transaction_date_key INNER JOIN
                         dim_days_banding ON CASE WHEN dim_transaction_date_key =
                             (SELECT   MAX(dim_transaction_date_key)
                                FROM         fact_disbursements_detail_monthly) THEN DATEDIFF(d, workdate, GETDATE()) ELSE DATEDIFF(d, workdate, trandate.calendar_date) END BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
WHERE   (fact_disbursements_detail_monthly.dim_bill_key = 0) AND (fact_disbursements_detail_monthly.total_unbilled_disbursements &lt;&gt; 0)
and          fact_disbursements_detail_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2022)

GROUP BY CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END, fact_disbursements_detail_monthly.dim_transaction_date_key, 
                         fact_disbursements_detail_monthly.dim_matter_header_curr_key, fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, 
                         fact_disbursements_detail_monthly.dim_client_key, fact_disbursements_detail_monthly.dim_bill_key, fact_dimension_main.master_client_code, fact_dimension_main.dim_fed_hierarchy_history_key, ISNULL(dim_client.client_code, 'Unknown'), fact_dimension_main.client_code, fact_disbursements_detail_monthly.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
        <Partition dwd:design-time-name="e4c72c57-8fdb-45ac-9b3d-86f8d581ab8c">
          <ID>Fact Disbursements Detail Monthly 2023</ID>
          <Name>Fact Disbursements Detail Monthly 2023</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="QueryBinding" dwd:design-time-name="5283afc6-99e5-49a6-bfae-90f844d5c53a">
            <DataSourceID>Red Dw</DataSourceID>
            <QueryDefinition>SELECT   fact_disbursements_detail_monthly.dim_transaction_date_key, fact_disbursements_detail_monthly.dim_matter_header_curr_key AS dim_matter_header_current_key, 
                         fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, fact_disbursements_detail_monthly.dim_client_key, 
                         CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END AS dim_disbursement_date_key, 
                         SUM(fact_disbursements_detail_monthly.total_unbilled_disbursements) AS total_unbilled_disbursements, fact_disbursements_detail_monthly.dim_bill_key, 
                       ISNULL(dim_client.client_code, 'Unknown') master_client_code, isnull(fact_dimension_main.dim_fed_hierarchy_history_key,0) AS matter_owner_hist_key, fact_disbursements_detail_monthly.source_system_id
FROM         fact_disbursements_detail_monthly left outer JOIN
                         fact_dimension_main ON fact_dimension_main.master_fact_key = fact_disbursements_detail_monthly.master_fact_key 
	LEFT outer JOIN dbo.dim_client ON dim_client.client_code = 
						 CASE WHEN ISNUMERIC(master_client_code) = 1 THEN RIGHT('00000000' + CONVERT(VARCHAR, master_client_code), 8) ELSE CAST(RTRIM(master_client_code) AS VARCHAR(8)) END
						  INNER join
                         dim_date AS trandate ON trandate.dim_date_key = fact_disbursements_detail_monthly.dim_transaction_date_key INNER JOIN
                         dim_days_banding ON CASE WHEN dim_transaction_date_key =
                             (SELECT   MAX(dim_transaction_date_key)
                                FROM         fact_disbursements_detail_monthly) THEN DATEDIFF(d, workdate, GETDATE()) ELSE DATEDIFF(d, workdate, trandate.calendar_date) END BETWEEN 
                         dim_days_banding.startdays AND dim_days_banding.enddays AND dim_days_banding.banding_category = 'grouping3'
WHERE   (fact_disbursements_detail_monthly.dim_bill_key = 0) AND (fact_disbursements_detail_monthly.total_unbilled_disbursements &lt;&gt; 0)
and          fact_disbursements_detail_monthly.dim_transaction_date_key IN (SELECT dim_date_key FROM dim_date WHERE fin_year = 2023)

GROUP BY CASE WHEN dim_disbursement_date_key &lt;= '20100501' THEN '20100501' ELSE dim_disbursement_date_key END, fact_disbursements_detail_monthly.dim_transaction_date_key, 
                         fact_disbursements_detail_monthly.dim_matter_header_curr_key, fact_disbursements_detail_monthly.dim_fed_hierarchy_history_key, dim_days_banding.dim_days_banding_key, 
                         fact_disbursements_detail_monthly.dim_client_key, fact_disbursements_detail_monthly.dim_bill_key, fact_dimension_main.master_client_code, fact_dimension_main.dim_fed_hierarchy_history_key, ISNULL(dim_client.client_code, 'Unknown'),   fact_dimension_main.client_code, fact_disbursements_detail_monthly.source_system_id</QueryDefinition>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
    </MeasureGroup>
    <MeasureGroup>
      <ID>Fact Write Off</ID>
      <Partitions>
        <Partition dwd:design-time-name="0bee6f5f-f478-4527-85c3-343a4121bce2">
          <ID>Fact Write Off</ID>
          <Name>Fact Write Off</Name>
          <CreatedTimestamp>0001-01-01T00:00:00Z</CreatedTimestamp>
          <LastSchemaUpdate>0001-01-01T00:00:00Z</LastSchemaUpdate>
          <LastProcessed>0001-01-01T00:00:00Z</LastProcessed>
          <State>Unprocessed</State>
          <Source xsi:type="DsvTableBinding" dwd:design-time-name="0482491a-1d7b-4246-988f-aec32d3a3d7a">
            <DataSourceViewID>FinanceDataSource</DataSourceViewID>
            <TableID>dbo_fact_write_off</TableID>
          </Source>
          <StorageMode>Molap</StorageMode>
          <CurrentStorageMode>Molap</CurrentStorageMode>
          <ProcessingMode>Regular</ProcessingMode>
        </Partition>
      </Partitions>
    </MeasureGroup>
  </MeasureGroups>
</Cube>